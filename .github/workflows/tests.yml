name: Tests workflow

env:
    ENVIRONMENT: development

on:
    pull_request:
    workflow_dispatch:

jobs:
    tests:
        name: Run tests ğŸ§ª
        runs-on: ubuntu-latest
        steps:
            -   name: Check out the repo ğŸ“¥
                uses: actions/checkout@v4

            -   name: Create env file âš™ï¸
                run: printf "${{ secrets.ENVS_DEV }}" >> .env

            -   name: Build docker containers ğŸ³
                run: DOCKER_BUILDKIT=1 docker compose -f docker-compose.yml -f docker-compose.dev.yml --profile default build

            -   name: Start docker containers ğŸš€
                run: DOCKER_BUILDKIT=1 docker compose -f docker-compose.yml -f docker-compose.dev.yml --profile default up -d

            -   name: Run tests âœ…
                run: python -m pytest
